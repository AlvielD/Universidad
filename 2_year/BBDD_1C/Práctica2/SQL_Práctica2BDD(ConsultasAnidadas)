--EI-
SELECT nombre
FROM EI.ALUMNO
WHERE lugar = (SELECT lugar
		FROM EI.ALUMNO
		WHERE nombre = 'Samuel Toscano Villegas')
     AND nH = (SELECT nH
		FROM EI.ALUMNO
		WHERE nombre = 'Beatriz Rico Vázquez');

--EI-
SELECT nombre
FROM EI.ALUMNO
WHERE nAl IN (SELECT M.alum
		FROM EI.ASIGNATURA A INNER JOIN EI.MATRICULA M USING (idAsig)
		WHERE A.nombre= 'Bases de Datos II')
AND nAl NOT IN (SELECT M.alum
		FROM EI.ASIGNATURA A INNER JOIN EI.MATRICULA M USING (idAsig)
		WHERE A.nombre = 'Bases de Datos I');

--EI-
SELECT nombre
FROM EI.PROFESOR
WHERE despacho <> 'FC-7366' AND
	ant < ANY(SELECT ant
		FROM EI.PROFESOR
		WHERE despacho = 'FC-7366');

--EI-
SELECT AL.nombre
FROM (EI.MATRICULA M INNER JOIN EI.ASIGNATURA A USING (idAsig))
		INNER JOIN EI.ALUMNO AL ON AL.nAl = alum
WHERE A.nombre = 'Bases de Datos I' AND año = 202
	AND sep > ALL (SELECT feb_jun
			FROM EI.MATRICULA M INNER JOIN EI.ASIGNATURA A USING (idAsig)
			WHERE nombre = 'Bases de Datos II' AND
				año = 2002 AND feb_jun IS NOT NULL);

---------------------------------------------------------------------------------------------------
							--SESIÓN 3: CONSULTAS ANIDADAS--
---------------------------------------------------------------------------------------------------
10-
SELECT DISTINCT Nombre
FROM WRC.RALLY INNER JOIN WRC.PARTICIPA USING(codRally)
WHERE codPiloto IN (SELECT codPiloto
                        FROM WRC.PILOTO
                        WHERE NombreCop NOT IN ('Marc Martí', 'Timo Rautiainen'));

11-
SELECT P.NombreP
FROM (WRC.PILOTO P INNER JOIN WRC.PARTICIPA A USING (codPiloto))
	INNER JOIN WRC.RALLY R USING (CODRALLY)
WHERE R.NOMBRE='Rally de Cataluña' AND A.PENALIZACION < 10 AND P.NombreP IN 
	(SELECT P.NombreP
	FROM WRC.PILOTO P INNER JOIN WRC.COCHE C ON P.COCHE=C.CODCOCHE
	WHERE C.MARCA='Subaru');

12-
SELECT DISTINCT R.nombre
FROM WRC.RALLY R INNER JOIN WRC.PARTICIPA P USING (CODRALLY)
WHERE P.CODPILOTO IN
	(SELECT codPiloto
	FROM WRC.PILOTO
	WHERE grupoS = 'A' AND rh = '+');

13-
SELECT NombreP
FROM (WRC.PILOTO INNER JOIN WRC.PARTICIPA USING (CODPILOTO))
WHERE codRally IN 
	(SELECT codRally
	FROM WRC.RALLY INNER JOIN WRC.TRAMO USING (codRally)
	WHERE DIFICULTAD='C');

14-
SELECT NOMBREP
FROM WRC.PILOTO
WHERE PUNTOS > ALL
	(SELECT PI.PUNTOS
	FROM WRC.PILOTO PI INNER JOIN WRC.COCHE C ON C.CODCOCHE = PI.COCHE
	WHERE C.MARCA = 'Subaru');

15-
SELECT P.NOMBREP, C.MODELO, R.NOMBRE
FROM ((WRC.PILOTO P INNER JOIN WRC.COCHE C ON P.COCHE=C.CODCOCHE)
      INNER JOIN WRC.PARTICIPA A USING (CODPILOTO))
      INNER JOIN WRC.RALLY R USING (CODRALLY)
WHERE R.NOMBRE IN
  (SELECT R.NOMBRE
  FROM WRC.RALLY R INNER JOIN WRC.TRAMO T USING (CODRALLY)
  WHERE T.TOTALKMS < 30);

